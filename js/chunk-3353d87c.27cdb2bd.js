(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3353d87c"],{4665:function(e,t,n){"use strict";n("99bf")},"99bf":function(e,t,n){},"9ed6":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"login-container"},[n("van-nav-bar",{staticClass:"app-nav-bar",attrs:{title:"注册/登录","left-text":"","left-arrow":""},on:{"click-left":function(t){return e.$router.back()}}}),n("van-form",{ref:"login-form",attrs:{"validate-first":"","show-error":!1,"show-error-message":!1},on:{submit:e.onLogin,failed:e.onFailed}},[n("van-cell-group",[n("van-field",{attrs:{name:"mobile","icon-prefix":"xinwen","left-icon":"shouji",placeholder:"请输入手机号",rules:e.formRules.mobile},model:{value:e.user.mobile,callback:function(t){e.$set(e.user,"mobile",t)},expression:"user.mobile"}}),n("van-field",{attrs:{name:"code",clearable:"","icon-prefix":"xinwen","left-icon":"yanzhengma",placeholder:"请输入验证码",rules:e.formRules.code},scopedSlots:e._u([{key:"button",fn:function(){return[e.showTime?n("van-count-down",{attrs:{time:3e3,format:"ss s"},on:{finish:function(t){e.showTime=!1}}}):n("van-button",{staticClass:"send-btn",attrs:{size:"mini",loading:e.isSendSmsLoding,round:""},on:{click:function(t){return t.preventDefault(),e.onSendSms(t)}}},[e._v("发送验证码")])]},proxy:!0}]),model:{value:e.user.code,callback:function(t){e.$set(e.user,"code",t)},expression:"user.code"}})],1),n("div",{staticClass:"login-btn-warp"},[n("van-button",{staticClass:"login-btn",attrs:{type:"info",block:""}},[e._v("登录")])],1)],1)],1)},o=[],a=(n("96cf"),n("1da1")),s=n("c24f"),i=n("d399"),u={name:"LoginIndex",data:function(){return{isSendSmsLoding:!1,showTime:!1,user:{mobile:"17090086870",code:"246810"},formRules:{mobile:[{required:!0,message:"请输入手机号"},{pattern:/^1[3|5|7|8|9]\d{9}$/,message:"手机号码格式错误"}],code:[{required:!0,message:"请填写验证码"},{pattern:/^\d{6}$/,message:"验证码格式错误"}]}}},methods:{onLogin:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return i["a"].loading({message:"加载中...",forbidClick:!0,duration:0}),t.prev=1,t.next=4,Object(s["f"])(e.user);case 4:n=t.sent,console.log("login-登录成功"),i["a"].success("登录成功"),e.$store.commit("setUser",n.data.data),e.$store.commit("removeCachePages","layoutIndex"),e.$router.push(e.$route.query.redirect||"/"),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](1),console.log(t.t0),i["a"].fail("登录失败",t.t0);case 16:case"end":return t.stop()}}),t,null,[[1,12]])})))()},onFailed:function(e){e.errors[0]&&Object(i["a"])({message:e.errors[0].message,position:"top"})},onSendSms:function(){var e=this;return Object(a["a"])(regeneratorRuntime.mark((function t(){var n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$refs["login-form"].validate("mobile");case 3:return t.next=5,Object(s["g"])(e.user.mobile);case 5:n=t.sent,console.log(n),e.showTime=!0,e.isSendSmsLoding=!0,t.next=17;break;case 11:t.prev=11,t.t0=t["catch"](0),r="",r=t.t0&&t.t0.response&&429===t.t0.response.status?"发送频繁，请稍后再试":"mobile"===t.t0.name?"手机号码格式错误":"未知错误，请稍后再试",Object(i["a"])({message:r,position:"top"}),e.isSendSmsLoding=!1;case 17:case"end":return t.stop()}}),t,null,[[0,11]])})))()}}},c=u,l=(n("4665"),n("2877")),d=Object(l["a"])(c,r,o,!1,null,"04f15e6e",null);t["default"]=d.exports},c24f:function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"i",(function(){return a})),n.d(t,"h",(function(){return s})),n.d(t,"f",(function(){return i})),n.d(t,"g",(function(){return u})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return l})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return f}));var r=n("b775"),o=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user/profile"})},a=function(e){return Object(r["a"])({method:"PATCH",url:"/app/v1_0/user/profile",data:e})},s=function(e){return Object(r["a"])({method:"PATCH",url:"/app/v1_0/user/photo",data:e})},i=function(e){return Object(r["a"])({method:"POST",url:"/app/v1_0/authorizations",data:e})},u=function(e){return Object(r["a"])({method:"GET",url:"/app/v1_0/sms/codes/".concat(e)})},c=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user"})},l=function(){return Object(r["a"])({method:"GET",url:"/app/v1_0/user/channels"})},d=function(e){return Object(r["a"])({method:"POST",url:"/app/v1_0/user/followings",data:{target:e}})},f=function(e){return Object(r["a"])({method:"DELETE",url:"/app/v1_0/user/followings/".concat(e)})}}}]);
//# sourceMappingURL=chunk-3353d87c.27cdb2bd.js.map