(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8dc1f190"],{"230c":function(t,e,n){"use strict";n.r(e);var o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"article-container"},[n("van-nav-bar",{staticClass:"app-nav-bar",attrs:{"left-arrow":"",title:"文章详情"},on:{"click-left":function(e){return t.$router.back()}}}),n("div",{staticClass:"article-wrap"},[n("h2",{staticClass:"title",domProps:{innerHTML:t._s(t.articleDetails.title)}}),n("van-cell",{attrs:{center:"",title:t.articleDetails.aut_name}},[n("span",{attrs:{slot:"label"},slot:"label"},[t._v(t._s(t._f("relativeTime")(t.articleDetails.pubdate)))]),n("van-image",{attrs:{slot:"icon",width:"35",height:"35",round:"",fit:"cover",src:t.articleDetails.aut_photo},slot:"icon"}),n("van-button",{attrs:{round:"",size:"small",loading:t.isFollowLoading,icon:t.articleDetails.is_followed?"":"plus",type:t.articleDetails.is_followed?"default":"info"},on:{click:t.onFollow}},[t._v(" "+t._s(t.articleDetails.is_followed?"已关注":"关注")+" ")])],1),n("div",{ref:"article-content",staticClass:"markdown-body",domProps:{innerHTML:t._s(t.articleDetails.content)}}),n("comment-List",{attrs:{list:t.commentList,source:t.articleId},on:{"update-total-count":function(e){t.updateTotalCount=e},"comment-update-popup":t.onCommentUpdate}})],1),n("div",{staticClass:"article-bottom"},[n("van-cell",[n("van-button",{attrs:{slot:"title",round:"",size:"small"},on:{click:function(e){t.isShowPopup=!0}},slot:"title"},[t._v("写评论 ")]),n("van-icon",{attrs:{name:"comment-o",badge:t.updateTotalCount}}),n("van-icon",{attrs:{loading:t.isCollectLoading,color:t.articleDetails.is_collected?"orange":"#777",name:t.articleDetails.is_collected?"star":"star-o"},on:{click:t.onStar}}),n("van-icon",{attrs:{loading:t.isLikingsLoading,color:1==t.articleDetails.attitude?"red":"#777",name:1==t.articleDetails.attitude?"good-job":"good-job-o"},on:{click:t.onLike}}),n("van-icon",{attrs:{name:"share"}})],1)],1),t.isShowPopup?n("van-popup",{attrs:{position:"bottom","get-container":"body"},model:{value:t.isShowPopup,callback:function(e){t.isShowPopup=e},expression:"isShowPopup"}},[n("post-Comment",{attrs:{target:t.articleId},on:{updatePopup:t.onUpdate}})],1):t._e(),n("van-popup",{staticClass:"comment-popup",attrs:{closeable:"",position:"bottom","get-container":"body"},model:{value:t.isCommentPopup,callback:function(e){t.isCommentPopup=e},expression:"isCommentPopup"}},[t.isCommentPopup?n("comment-Reply",{attrs:{target:t.articleId,articleId:t.articleId,isCommentPopup:t.isCommentPopup,userCommentList:t.userCommentList}}):t._e()],1)],1)},r=[],a=(n("4160"),n("a9e3"),n("159b"),n("96cf"),n("1da1")),i=(n("945f"),n("2423")),c=n("c24f"),s=n("28a2"),u=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-container"},[n("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},[n("van-cell",[n("h4",{staticClass:"text-center",attrs:{slot:"title"},slot:"title"},[t._v("全部评论")])]),t._l(t.list,(function(e,o){return n("comment-Item",{key:o,attrs:{item:e},on:{"comment-update-popup":function(e){return t.$emit("comment-update-popup",e)}}})}))],2)],1)},l=[],d=(n("d3b7"),n("25f0"),n("2909")),f=n("b775"),p=function(t){return Object(f["a"])({method:"GET",url:"/app/v1_0/comments",params:t})},m=function(t){return Object(f["a"])({method:"POST",url:"/app/v1_0/comments",data:t})},b=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("van-cell",{staticClass:"comment-item"},[n("van-cell",{attrs:{center:"",title:t.item.aut_name}},[n("span",{attrs:{slot:"label"},slot:"label"},[t._v(t._s(t._f("datetime")(t.item.pubdate,"MM:DD HH:mm")))]),n("van-image",{attrs:{slot:"icon",width:"36",height:"36",round:"",fit:"cover",src:t.item.aut_photo},slot:"icon"}),n("van-button",{attrs:{round:"",size:"small",type:"primary"},on:{click:function(e){return t.onComment()}}},[t._v(" 回复"+t._s(t.item.reply_count)+" ")])],1),n("van-cell",[t._v(t._s(t.item.content?t.item.content:"没有就只好显示我咯~,没有就只好显示我咯~,没有就只好显示我咯~"))])],1)},v=[],h={name:"CommentItem",props:{item:{type:[Object,Array],required:!0}},components:{},data:function(){return{}},computed:{},watch:{},methods:{onComment:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.$emit("comment-update-popup",t.item);case 1:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},activated:function(){}},g=h,_=(n("4312"),n("2877")),w=Object(_["a"])(g,b,v,!1,null,"567b054e",null),y=w.exports,C={name:"comment-list",props:{source:{type:[Number,Object,String],required:!0},type:{type:String,default:"a"},list:{type:Array,default:function(){return[]}}},components:{CommentItem:y},data:function(){return{loading:!1,finished:!1,offset:null,limit:10}},computed:{},watch:{},methods:{onLoad:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,o,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,p({type:t.type,source:t.source.toString(),offset:t.offset,limit:t.limit});case 2:o=e.sent,r=o.data,t.$emit("update-total-count",r.data.total_count),a=r.data.results,(n=t.list).push.apply(n,Object(d["a"])(a)),console.log(t.list),t.loading=!1,a.length?(t.offset=r.data.last_id,console.log("还有")):(t.finished=!0,console.log("没有了"));case 10:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},activated:function(){}},O=C,j=(n("3352"),Object(_["a"])(O,u,l,!1,null,"65fce4f4",null)),x=j.exports,S=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"post-comment"},[n("van-field",{attrs:{rows:"2",autosize:"",type:"textarea",maxlength:"80","show-word-limit":""},model:{value:t.message,callback:function(e){t.message="string"===typeof e?e.trim():e},expression:"message"}}),n("van-button",{attrs:{disabled:!t.message},on:{click:t.onPost}},[t._v("发布")])],1)},I=[],L={name:"postComment",props:{target:{type:[Object,Number,String],required:!0},articleId:{type:[Object,Number,String],default:null}},components:{},data:function(){return{message:""}},computed:{},watch:{},methods:{onPost:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,m({target:t.target.toString(),content:t.message,art_id:t.articleId?t.articleId.toString():null});case 2:n=e.sent,o=n.data,console.log(o),t.$emit("updatePopup",o.data.new_obj),t.$toast("评论成功"),t.message="";case 8:case"end":return e.stop()}}),e)})))()}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},activated:function(){}},k=L,P=(n("82f7"),Object(_["a"])(k,S,I,!1,null,"2be9f596",null)),E=P.exports,D=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"comment-reply"},[n("van-nav-bar",{attrs:{title:t.userCommentList.reply_count+"条回复"}}),n("comment-item",{attrs:{item:t.userCommentList}}),n("comment-list",{attrs:{source:t.userCommentList.com_id,type:"c",list:t.commentList}}),n("div",{staticClass:"article-bottom"},[n("van-cell",[n("van-button",{attrs:{slot:"title",round:"",size:"small"},on:{click:function(e){t.isShowPopup=!0}},slot:"title"},[t._v("写评论 ")])],1)],1),n("van-popup",{staticClass:"comment-popup",attrs:{closeable:"",position:"bottom","get-container":"body"},model:{value:t.isShowPopup,callback:function(e){t.isShowPopup=e},expression:"isShowPopup"}},[n("post-Comment",{attrs:{target:t.userCommentList.com_id,articleId:t.articleId},on:{updatePopup:t.onPostSuccess}})],1)],1)},A=[],T={name:"CommentReply",props:{userCommentList:{type:Object,required:!0},articleId:{type:[Object,Number,String],required:!0}},components:{commentItem:y,commentList:x,postComment:E},data:function(){return{isShowPopup:!1,commentList:[]}},computed:{},watch:{},methods:{onPostSuccess:function(t){this.commentList.unshift(t),this.userCommentList.reply_count++,this.isShowPopup=!1}},created:function(){},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},activated:function(){}},R=T,N=(n("75ed"),Object(_["a"])(R,D,A,!1,null,"57203dcc",null)),$=N.exports,M={name:"articleDetails",props:{articleId:{type:[String,Object,Number],required:!0}},components:{commentList:x,postComment:E,commentReply:$},data:function(){return{articleDetails:{},isFollowLoading:!1,isCollectLoading:!1,isLikingsLoading:!1,isShowPopup:!1,isCommentPopup:!1,userCommentList:{},commentList:[],updateTotalCount:0}},computed:{},watch:{},methods:{loadArticleById:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){var n,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["e"])(t.articleId);case 2:n=e.sent,o=n.data,t.articleDetails=o.data,t.$nextTick((function(){t.handlePoreviewImage()}));case 6:case"end":return e.stop()}}),e)})))()},handlePoreviewImage:function(){var t=this.$refs["article-content"],e=t.querySelectorAll("img"),n=[];e.forEach((function(t,e){n.push(t.src),t.onclick=function(){Object(s["a"])({images:n,startPosition:e})}}))},onFollow:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isFollowLoading=!0,!t.articleDetails.is_followed){e.next=7;break}return e.next=4,Object(c["b"])(t.articleDetails.aut_id);case 4:t.$toast("取消成功"),e.next=10;break;case 7:return e.next=9,Object(c["a"])(t.articleDetails.aut_id);case 9:t.$toast("关注成功");case 10:t.articleDetails.is_followed=!t.articleDetails.is_followed,t.isFollowLoading=!1;case 12:case"end":return e.stop()}}),e)})))()},onStar:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isCollectLoading=!0,!t.articleDetails.is_collected){e.next=7;break}return e.next=4,Object(i["a"])(t.articleId);case 4:t.$toast("取消成功"),e.next=10;break;case 7:return e.next=9,Object(i["c"])(t.articleId);case 9:t.$toast("关注成功");case 10:t.articleDetails.is_collected=!t.articleDetails.is_collected,t.isCollectLoading=!1;case 12:case"end":return e.stop()}}),e)})))()},onLike:function(){var t=this;return Object(a["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.isLikingsLoading=!0,1===t.articleDetails.attitude){e.next=7;break}return e.next=4,Object(i["b"])(t.articleId);case 4:t.articleDetails.attitude=1,e.next=11;break;case 7:if(-1===t.articleDetails.attitude){e.next=11;break}return e.next=10,Object(i["d"])(t.articleId);case 10:t.articleDetails.attitude=-1;case 11:t.isLikingsLoading=!1;case 12:case"end":return e.stop()}}),e)})))()},onUpdate:function(t){this.commentList.unshift(t),this.updateTotalCount++,this.isShowPopup=!1},onCommentUpdate:function(t){console.log("远程接力biu~biu~",t),this.userCommentList=t,this.isCommentPopup=!0,console.log("2级评论")},postComment:function(){this.updateTotalCount++,this.isCommentPopup=!1}},created:function(){this.loadArticleById()},mounted:function(){},beforeCreate:function(){},beforeMount:function(){},beforeUpdate:function(){},updated:function(){},beforeDestroy:function(){},activated:function(){}},F=M,U=(n("c874"),n("471e"),Object(_["a"])(F,o,r,!1,null,"3ddb9006",null));e["default"]=U.exports},2423:function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"e",(function(){return a})),n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return s})),n.d(e,"d",(function(){return u}));var o=n("b775"),r=function(t){return Object(o["a"])({method:"GET",url:"/app/v1_1/articles",params:t})},a=function(t){return Object(o["a"])({method:"GET",url:"/app/v1_0/articles/".concat(t)})},i=function(t){return Object(o["a"])({method:"POST",url:"/app/v1_0/article/collections",data:{target:t}})},c=function(t){return Object(o["a"])({method:"DELETE",url:"/app/v1_0/article/collections/".concat(t)})},s=function(t){return Object(o["a"])({method:"POST",url:"/app/v1_0/article/likings",data:{target:t}})},u=function(t){return Object(o["a"])({method:"DELETE",url:"/app/v1_0/article/likings/".concat(t)})}},"25f0":function(t,e,n){"use strict";var o=n("6eeb"),r=n("825a"),a=n("d039"),i=n("ad6d"),c="toString",s=RegExp.prototype,u=s[c],l=a((function(){return"/a/b"!=u.call({source:"a",flags:"b"})})),d=u.name!=c;(l||d)&&o(RegExp.prototype,c,(function(){var t=r(this),e=String(t.source),n=t.flags,o=String(void 0===n&&t instanceof RegExp&&!("flags"in s)?i.call(t):n);return"/"+e+"/"+o}),{unsafe:!0})},2909:function(t,e,n){"use strict";function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}function r(t){if(Array.isArray(t))return o(t)}n.d(e,"a",(function(){return s}));n("a4d3"),n("e01a"),n("d28b"),n("a630"),n("d3b7"),n("3ca3"),n("ddb0");function a(t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}n("fb6a"),n("25f0");function i(t,e){if(t){if("string"===typeof t)return o(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}}function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(t){return r(t)||a(t)||i(t)||c()}},3352:function(t,e,n){"use strict";n("fd07")},4312:function(t,e,n){"use strict";n("66d9")},"46ed":function(t,e,n){},"471e":function(t,e,n){"use strict";n("db8c")},"4df4":function(t,e,n){"use strict";var o=n("0366"),r=n("7b0b"),a=n("9bdd"),i=n("e95a"),c=n("50c4"),s=n("8418"),u=n("35a1");t.exports=function(t){var e,n,l,d,f,p,m=r(t),b="function"==typeof this?this:Array,v=arguments.length,h=v>1?arguments[1]:void 0,g=void 0!==h,_=u(m),w=0;if(g&&(h=o(h,v>2?arguments[2]:void 0,2)),void 0==_||b==Array&&i(_))for(e=c(m.length),n=new b(e);e>w;w++)p=g?h(m[w],w):m[w],s(n,w,p);else for(d=_.call(m),f=d.next,n=new b;!(l=f.call(d)).done;w++)p=g?a(d,h,[l.value,w],!0):l.value,s(n,w,p);return n.length=w,n}},"52a2":function(t,e,n){},5899:function(t,e){t.exports="\t\n\v\f\r                　\u2028\u2029\ufeff"},"58a8":function(t,e,n){var o=n("1d80"),r=n("5899"),a="["+r+"]",i=RegExp("^"+a+a+"*"),c=RegExp(a+a+"*$"),s=function(t){return function(e){var n=String(o(e));return 1&t&&(n=n.replace(i,"")),2&t&&(n=n.replace(c,"")),n}};t.exports={start:s(1),end:s(2),trim:s(3)}},"66d9":function(t,e,n){},7156:function(t,e,n){var o=n("861d"),r=n("d2bb");t.exports=function(t,e,n){var a,i;return r&&"function"==typeof(a=e.constructor)&&a!==n&&o(i=a.prototype)&&i!==n.prototype&&r(t,i),t}},"75ed":function(t,e,n){"use strict";n("52a2")},"80d9":function(t,e,n){},"82f7":function(t,e,n){"use strict";n("80d9")},"945f":function(t,e,n){},"9bdd":function(t,e,n){var o=n("825a"),r=n("2a62");t.exports=function(t,e,n,a){try{return a?e(o(n)[0],n[1]):e(n)}catch(i){throw r(t),i}}},a630:function(t,e,n){var o=n("23e7"),r=n("4df4"),a=n("1c7e"),i=!a((function(t){Array.from(t)}));o({target:"Array",stat:!0,forced:i},{from:r})},a9e3:function(t,e,n){"use strict";var o=n("83ab"),r=n("da84"),a=n("94ca"),i=n("6eeb"),c=n("5135"),s=n("c6b6"),u=n("7156"),l=n("c04e"),d=n("d039"),f=n("7c73"),p=n("241c").f,m=n("06cf").f,b=n("9bf2").f,v=n("58a8").trim,h="Number",g=r[h],_=g.prototype,w=s(f(_))==h,y=function(t){var e,n,o,r,a,i,c,s,u=l(t,!1);if("string"==typeof u&&u.length>2)if(u=v(u),e=u.charCodeAt(0),43===e||45===e){if(n=u.charCodeAt(2),88===n||120===n)return NaN}else if(48===e){switch(u.charCodeAt(1)){case 66:case 98:o=2,r=49;break;case 79:case 111:o=8,r=55;break;default:return+u}for(a=u.slice(2),i=a.length,c=0;c<i;c++)if(s=a.charCodeAt(c),s<48||s>r)return NaN;return parseInt(a,o)}return+u};if(a(h,!g(" 0o1")||!g("0b1")||g("+0x1"))){for(var C,O=function(t){var e=arguments.length<1?0:t,n=this;return n instanceof O&&(w?d((function(){_.valueOf.call(n)})):s(n)!=h)?u(new g(y(e)),n,O):y(e)},j=o?p(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),x=0;j.length>x;x++)c(g,C=j[x])&&!c(O,C)&&b(O,C,m(g,C));O.prototype=_,_.constructor=O,i(r,h,O)}},c24f:function(t,e,n){"use strict";n.d(e,"e",(function(){return r})),n.d(e,"i",(function(){return a})),n.d(e,"h",(function(){return i})),n.d(e,"f",(function(){return c})),n.d(e,"g",(function(){return s})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return f}));var o=n("b775"),r=function(){return Object(o["a"])({method:"GET",url:"/app/v1_0/user/profile"})},a=function(t){return Object(o["a"])({method:"PATCH",url:"/app/v1_0/user/profile",data:t})},i=function(t){return Object(o["a"])({method:"PATCH",url:"/app/v1_0/user/photo",data:t})},c=function(t){return Object(o["a"])({method:"POST",url:"/app/v1_0/authorizations",data:t})},s=function(t){return Object(o["a"])({method:"GET",url:"/app/v1_0/sms/codes/".concat(t)})},u=function(){return Object(o["a"])({method:"GET",url:"/app/v1_0/user"})},l=function(){return Object(o["a"])({method:"GET",url:"/app/v1_0/user/channels"})},d=function(t){return Object(o["a"])({method:"POST",url:"/app/v1_0/user/followings",data:{target:t}})},f=function(t){return Object(o["a"])({method:"DELETE",url:"/app/v1_0/user/followings/".concat(t)})}},c874:function(t,e,n){"use strict";n("46ed")},db8c:function(t,e,n){},fb6a:function(t,e,n){"use strict";var o=n("23e7"),r=n("861d"),a=n("e8b5"),i=n("23cb"),c=n("50c4"),s=n("fc6a"),u=n("8418"),l=n("b622"),d=n("1dde"),f=n("ae40"),p=d("slice"),m=f("slice",{ACCESSORS:!0,0:0,1:2}),b=l("species"),v=[].slice,h=Math.max;o({target:"Array",proto:!0,forced:!p||!m},{slice:function(t,e){var n,o,l,d=s(this),f=c(d.length),p=i(t,f),m=i(void 0===e?f:e,f);if(a(d)&&(n=d.constructor,"function"!=typeof n||n!==Array&&!a(n.prototype)?r(n)&&(n=n[b],null===n&&(n=void 0)):n=void 0,n===Array||void 0===n))return v.call(d,p,m);for(o=new(void 0===n?Array:n)(h(m-p,0)),l=0;p<m;p++,l++)p in d&&u(o,l,d[p]);return o.length=l,o}})},fd07:function(t,e,n){}}]);
//# sourceMappingURL=chunk-8dc1f190.05135ed3.js.map